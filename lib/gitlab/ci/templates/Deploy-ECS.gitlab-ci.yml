stages:
  - build
  - review
  - production

# build stage
include:
  - template: Jobs/Build.gitlab-ci.yml

# review stage
.deploy_to_ecs:
  image: registry.gitlab.com/gitlab-org/cloud-deploy:latest
  script:
    - ecs update-task-definition

# review stage
deploy review app:
  extends: .deploy_to_ecs
  stage: review
  only:
    refs:
      - branches
      - tags

# production stage
production:
  extends: .deploy_to_ecs
  stage: production
  only:
    refs:
      - master
