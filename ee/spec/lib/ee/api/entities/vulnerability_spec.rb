# frozen_string_literal: true

require 'spec_helper'

describe EE::API::Entities::Vulnerability do
  let(:vulnerability) { create(:vulnerability) }

  subject { described_class.new(vulnerability).as_json }

  it "exposes a link to the vulnerability's detail page" do
    expect(subject[:vulnerability_path]).to eq(
      Gitlab::Routing.url_helpers.project_security_vulnerability_path(vulnerability.project, vulnerability)
    )
  end
end
