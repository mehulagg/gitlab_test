stages:
  - test
  - qa

variables:
  SAST_DISABLE_DIND: "true"
  SCAN_KUBERNETES_MANIFESTS: "true"
  CI_DEBUG_TRACE: "false"
  SAST_ANALYZER_IMAGE_PREFIX: "registry.gitlab.com/gitlab-org/security-products/analyzers"
  SAST_DEFAULT_ANALYZERS: "bandit, brakeman, gosec, spotbugs, flawfinder, phpcs-security-audit, security-code-scan, nodejs-scan, eslint, tslint, secrets, sobelow, pmd-apex, kubesec"
  SAST_ANALYZER_IMAGE_TAG: 2
  DOCKER_DRIVER: overlay2
  DOCKER_TLS_CERTDIR: ""
  SAST_BRAKEMAN_LEVEL: 2
  SAST_EXCLUDED_PATHS: qa,spec,doc,ee/spec
  # SAST_DEFAULT_ANALYZERS: "brakeman, kubesec"
  # SAST_ANALYZER_IMAGE_TAG: "error-walking-dir" #this does no good for SAST !@#$&*(^#$@%

include:
  - template: SAST.gitlab-ci.yml

